(function(window,document,reqVersion,callback,$,script,done,readystate){'use strict';if(!($=window.jQuery)||reqVersion>$.fn.jquery||callback($)){script=document.createElement('script');script.type='text/javascript';script.src='//ajax.googleapis.com/ajax/libs/jquery/'+reqVersion+'/jquery.min.js';script.onload=script.onreadystatechange=function(){if(!done&&(!(readystate=this.readyState)||readystate==='loaded'||readystate==='complete')){callback(($=window.jQuery).noConflict(1),done=1);$(script).remove();}};document.getElementsByTagName('head')[0].appendChild(script);}})(window,document,'1.7.2',function($){'use strict';var horseEbookmarklet={tweetArray:[],init:function(){this.getTweets();},getTweets:function(){var that=this;$.getJSON('//api.twitter.com/1/statuses/user_timeline.json?screen_name=horse_ebooks&count=200&callback=?',function(data){var urlRegex=/(https?:\/\/[^\s]+)/g;var tweetCount=data.length;for(var i=0;i<tweetCount;i++){var tweetText=data[i].text.replace(urlRegex,'');var tweetObject={text:tweetText,length:tweetText.length};that.tweetArray.push(tweetObject);}that.cacheElements();that.replaceText();that.replaceImages();});},cacheElements:function(){this.textElements=$('p, h1, h2, h3, h4, h5, h6, li, a, div, span'),this.imgElements=$('img');},replaceImages:function(){this.imgElements.each(function(){var w=$(this).width(),h=$(this).height();var newImg=$(document.createElement('div')).css({width:w,height:h,overflow:'hidden'}).html('<img src="//www.heyben.com/horse_ebookmarklet/img/horse_ebookmarklet.jpg" alt="horse_ebooks" style="width: 100%; max-width: 100%; min-width: 100%; height: auto;" />');$(this).replaceWith(newImg);});},replaceText:function(){var that=this;this.textElements.each(function(){var textLength=$(this).text().length;if((textLength>2)&&$(this).children().length===0){var replacementText=that.getReplacementTweet(textLength);$(this).text(replacementText);}});},getReplacementTweet:function(length){if(length<140){this.greppedTweets=$.grep(this.tweetArray,function(n){return(n.length>(length-4)&&n.length<(length+4));});}else{this.greppedTweets=$.grep(this.tweetArray,function(n){return(n.length>130&&n.length<140);});}var tweet=this.greppedTweets[Math.floor(Math.random()*this.greppedTweets.length)];if(typeof tweet==='undefined'){tweet=false;}return tweet.text;}};horseEbookmarklet.init();});